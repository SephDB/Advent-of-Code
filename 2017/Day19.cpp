#include <iostream>
#include <string_view>
#include <complex>

using namespace std::string_view_literals;

struct Grid {
    std::string_view grid;
    int width;
    int start;
    char operator[](std::complex<int> loc) const {
        return grid[loc.imag()*width + loc.real()];
    }
};

auto parse(std::string_view input) {
    int start = input.find('|');
    int width = input.find('\n',start)+1;
    return Grid{input,width,start};
}

auto part1(decltype(parse("")) grid) {
    int count = 1;
    std::complex<int> loc = {grid.start,0},dir = {0,1}, left = {0,1}, right = {0,-1};
    while(true) {
        while(grid[loc += dir] != '+') {
            if(grid[loc] == ' ') return count;
            ++count;
            if("-|"sv.find(grid[loc]) == std::string_view::npos) {
                std::cout << grid[loc];
            }
        }
        ++count;
        if(grid[loc + dir*left] != ' ') dir *= left;
        else if(grid[loc + dir*right] != ' ') dir *= right;
    }
}

void solution(std::string_view input) {
    auto in = parse(input);
    std::cout << "Part 1: ";
    int count = part1(in);
    std::cout << '\n';
    std::cout << "Part 2: " << count << '\n';
}

std::string_view input = R"(               |                                                                                                                                                                                         
             +---------------------------------------------------+                 +-+         +-----+       +-------------------------------+     +-------------------------------------+         +---+ 
             | |                                                 |                 | |         |     |       |                               |     |                                     |         |   | 
             | |         +-----+     +---------------------------|-------------------|---------+     |       |                               |     |                             +-----+ |         |   | 
             | |         |     |     |                           |                 | |               |       |                               |     |                             |     | |         |   | 
             +---+ +-+   |     +---+ +-----------------------------+               | +---------------+       |                         +-----------|-----------------------------|---+ +-+     +---|-+ | 
               | | | |   |         |                             | |               |                         |                         |     |     |                             |   |         |   | | | 
               | | +-|---+ +---+ +-|-----------------------------|-|-------------------------------------------------------+           |     |     +-------------------------------------------|---|-+ | 
               | |   |     |   | | |                             | |               |                         |             |           |     |                                   |   |         |   |   | 
             +---|-+ |   +-|---|-----------------------------------|-----------------------------+           +-------------|-----------|-------------------------------------------------------|-----+ | 
             | | | | |   | |   | | |                             | |               |             |                         |           |     |                                   |   |         |   | | | 
             | | | | |   | |   | | |             +---+   +-+     | +---------------|-----------------------------------------------+   |     |                                   |   |         |   | | | 
             | | | | |   | |   | | |             |   |   | |     |                 |             |                         |       |   |     |                                   |   |         |   | | | 
             +---|-|-----|-|---|-|---+           |   |   | |     | +---------------|--------------------------------P--------------|-------------------------------------------------------+   |   | | | 
               | | | |   | |   | | | |           |   O   | |     | |               |             |                         |       |   |     |                                   |   |     |   |   | | | 
               | | | |   | |   | | | +-----------|-------|-----------------------------------------------------------------------------------------------------------------+     |   |     |   |   | | | 
               | | | |   | |   | | |             |   |   | |     | |               |             |                         |       |   |     |                             |     |   |     |   |   | | | 
   +-------+   | | | |   | | +---|-|---+       +-|---+   | |     | |               |             |                         |       |   |     |                             |     |   |     |   |   | | | 
   |       |   | | | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |     |                             |     |   |     |   |   | | | 
   |       |   | | | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |   +-------------------+           |     |   |   +-+   |   | | | 
   |       |   | | | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |   | |                 |           |     |   |   |     |   | | | 
   |     +-+   | +-------|-----|-|-|---|-------------------|-----|-|-----------------------------|-------------------------|-------|---------------------------|-----------------|---|---|-+   |   | | | 
   |     |     |   | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |   | |                 |           |     |   |   | |   |   | | | 
   |     +-----|---|-----|-----|---|-----------|-+   +---|-|-----|-----------------|-----------------------------------------------|-------|-|-------------------------+   |   +-|---|---|-+   |   | | | 
   |           |   | |   | | | M | |   |       |     |   | |     | |               |             |                         |       |   |   | |                 |       |   |   | |   |   |     |   | | | 
 +-|-+     +-+ | +---|---+ | | | +---------+   |     |   | |     | |               |             |                         |       |   |   | | +---------------------+ |   |   | |   |   |     |   | | | 
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |               |             |                         |       |   |   | | |               |     | |   |   | |   |   |     |   | | | 
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |               |             |                         |       |   |   | | |               |     | |   |   | |   |   |     |   | | | 
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |               |             |                         |       |   |   | | |               |     | |   |   | |   |   |     |   | | | 
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |   +-----------|-------------|---------------------------------|-----------|-----+         | +-------------|-|-------+     |   | | | 
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |   |           |             |                         |       |   |   | | |     |         | |   | |   |   | |   |         |   | | | 
 | | |     | +-|-----------|-|-|---|---|----------------S--|-----|-------------------------------|-----------------+       |       |   |   | +-------------------+   | |   |   | | +-|L----+   |   | | | 
 | | |     |   | | | |     | | |   |   |   |   |     |   | |     | |   |           |             |                 |       |       |   |   |   |     |         |     | |   |   | | | |     |   |   | | | 
 | | |     |   | | | |     | | | +-|-----------|-----------|-----|-----|-----------|-+           |                 |       |       +---|---|-----------+       |     | |   |   | | | |     |   |   | | | 
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | | 
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | | 
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | | 
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | | 
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | | 
 | | |     +-+ | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       +-----------|---|---------|-|-------|-----|-|-------|-|-+ |     |   |   | | | 
 | | |       | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |     | |   |   | |   |     |   |   | | | 
 +-|-|-------|-------------|-----|-|-------|---------------------|-------------------|-----------|---------------------------------------------------|-|-------|-----+ |   |   | |   |     +---+   | | | 
   | |       | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |             | | | 
   | +-+     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |             | | | 
   |   |     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |             | | | 
   |   |     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |         +-+ | | | 
   |   |     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |         | | | | | 
   |   | +-----|-+ +-|-----|---|-|---------|---|---------|-|-----------|-----------|-|-----------|-+               |       +---+       |   |   | +-------------|---------+ |   | |   |         | | | | | 
   |   | |   | |     |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |   |       |   |   | |   | |       |       | | |   | |   |         | | | | | 
   |   | |   | |     |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |   +-----------------|---|---------|---+   | | |   | |   |         | | | | | 
   |   | |   | |     |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |           |   |   | |   | |       |   |   | | |   | |   |         | | | | | 
   |   | |   | | +-+ |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |           |   |   | |   | |       |   |   | | |   | |   |         | | | | | 
   |   | |   | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |           |   |   | |   | |       |   |   | | |   | |   |         | | | | | 
   |   | |   | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           | |           +---|-------|-----------|---+   | |   | |       |   |   | | |   | |   |         | | | | | 
   |   | |   | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           | |           |   |       |           |       | |   | |       |   |   | | |   | |   |         | | | | | 
   |   | |   | | | | |     | | | | |   |   |   | +-----+ | |     | |   |           | |           | |     +---------|-------------------|---------|---|-|-------|---|-----|-------|---------+   | | | | | 
   |   | |   | | | | |     | | | | |   |   |   | |   | | | |     | |   |           | |           | |     |     |   |       |           |       | |   | |       |   |   | | |   | |   |     |   | | | | | 
   +---|-----|-----|-------|---|---+   |   |   | |   | | | |     | |   +-----+     | |           | |     |     |   +-------------------|-------|-|-----|-------|---|-----|-|---------------|-+ | | | | | 
       | |   | | | | |     | | | |     |   |   | |   | | | |     | |         |     | |           | |     |     |           |           |       | |   | |       |   |   | | |   | |   |     | | | | | | | 
       | |   | | | | |     | | | |     |   |   | |   | | | |     | |         |     | |           | |     |     |           |           |       | |   | |       |   |   | | |   | |   |     | | | | | | | 
       | |   | | | | |     | | | |     |   |   | |   | | | |     | |         |     | |           | |     |     |           |           |       | |   | |       |   |   | | |   | |   |     | | | | | | | 
     +---|---|-|-----|-----|-----+     |   |   | |   | | | |     | |   +-----|-----|-------------|-|-----------------------|-----------|-+     | |   | |       |   |   | | |   | |   |   +-|---+ | | | | 
     | | |   | | | | |     | | |       |   |   | |   | | | |     | |   |     |     | |           | |     |     |           |           | |     | |   | |       |   |   | | |   | |   |   | | |   | | | | 
   +---------------|---------|---------|---------|---+ | | | +-----|---------------|-------------|-|-----------|-----------|-----------+ |   +-+ |   | |       |   | +-----|-----|---|-------------+ | | 
   | | | |   | | | | |     | | |       |   |   | |     | | | |   | |   |     |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   |   | | 
   | | | |   +-|-|---|-----|---|-+     |   |   | |     | | | |   | |   |   +-|-------|-------------|-----------|-----------|---------------------------|-------|---|-----|-|-----|---|---------+ |   | | 
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | | | |   | | 
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | +-|---+ | | 
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | |   | | | | | 
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | +-+ | | | | 
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   | | | | 
   | | | |   +-|-|---|-----|-----------|-------|-------|---|-----------------|-----|-|-------------------+     |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   | | | | 
   | | | |   | | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   | | | | 
   | | | |   | | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |   +-|-------+   | | | | |   | |   |   | | |   | | | | 
   | | | |   | | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |           | | | | |   | |   |   | | |   | | | | 
   | | | |   | | | | |     | | | +-----|---|---|-------|-|---------|-----------------+           | |           |           |             |   |   |     |     +-+   | | | | |   | |   |   | | +-----+ | | 
   | | | |   | | | | |     | | |       |   |   | |     | | | |   | |   |   | |     |             | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     |   | | 
   | | | |   | | | | +-+   | | |       |   |   | |     | | | |   | |   |   | |     | +-----------|-------------------------------------------------------------|-----|-|-|-|-----|---|-----|----A|-+ | | 
   | | | |   | | | |   |   | | |       |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     | | | | 
   | | | |   | | | |   |   | | |       |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     | | | | 
   | | | |   | | | |   |   | | |       |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     | | | | 
   | | | |   | | | |   |   +---|-----+ |   |   | |     | | | |   | |   |   | |     | |           +-|-----------|-------------------------|-------|-----------------------|-|-------------|-+     | | | | 
   | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |   |     |     | |   | | | | |   | |   |   |       | | | | 
   | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |   |     |     | |   | | | | |   | |   |   |       | | | | 
   | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |   |     |     | |   | | | | |   | |   |   |       | | | | 
 +---|-|-|---|-----|---|-------|-----|-----|-----|-----|---|-|---|-----------------|-|-----------------------------------------------------------+     |     | |   | | | | |   | |   |   |       | | | | 
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | | 
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | | 
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | | 
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | | 
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | | 
 | | | | |   | | | | +---------------------------|-----|---|-|-----|---|---|-------|-|-------------------------+           |             |   |         |     | |   | | | | |   | |   |   |       | | | | 
 | | | | |   | | | | | |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |                       |             |   |         |     | |   | | | | |   | |   |   |       | | | | 
 | | +-|-|---|---------------|-|-----------|-----|-------|---|---------|-----------|---------------------------------------------------------|---------|-----|-------|-+ | |   | |   |   |       | | | | 
 | |   | |   | | | | | |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |                       |             |   |         |     | |   | |   | |   | |   |   |       | | | | 
 | +-----|---+ | | +-|---+   | | +---|-|---|-+ | |     | | | |   | |   |   | |     | |     +-------|-------------------------------------|---|---------------|-|---|-|---------|-|---|---|-------|-|-|-+ 
 |     | |     | |   | | |   | | |   | |   | | | |     | | | |   | |   |   | |     | |     |       |                       |             |   |         |     | |   | |   | |   | |   |   |       | | |   
 | +---|---+ +-+ +---|-|-|---|-|-----|-----|---|-----------|-|---|-----|-+ | |     | |     |       |           +-------------------------|-------------|-----|-|---|-----------------|---|-------|-|-+   
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | | | |     | |     |       |           |           |             |   |         |     | |   | |   | |   | |   |   |       | |     
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | +---|---------------------|-------------------------------------|-------------------|-|---|-------|-+ | |   |   |       | |     
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   |   | |     | |     |       |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |     
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | +-----------|-------------|-------------------------------------|---|-----------------|-----|---|---|-|-----|---|-------|-----+ 
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | | | |     | |     |       |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |   | 
 | |   | | | |       | | | +-----|---|-|-----|-|-|-----|---|-----|-------|---------------------+   |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |   | 
 | |   | | | |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |   | 
 | |   | | +-----------------|---------|---------|-------|-|-|---|-|---------|-----|-|---------|---|-----------|-----------|-----------------|---------|-------|---|-----|---|-|-|---|-------+   | |   | 
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |   | |   | 
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |   +---+ | 
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |     | | | 
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |     | | | 
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |     | | | 
 | +---|-|---|---------|-|-|---|-----|-----------|-------+ | |   | |   | | | |     | |     |   +---|-----------------------|---------------------------|-----|-----|-|---|-+ | | |   |   |   |     | | | 
 |     | |   |       | | | | | | |   | |   | | | |     |   | |   | |   | | | |     | |     |       |           |           |             |   |         |     | |   | |   |   | | |   |   |   |     | | | 
 |     | | +-----------+ | | | | |   | |   | | | |     |   | |   | |   | | | |     +-|-----|-------------------|---------+ |             |   |         |     | |   | |   |   | | |   |   |   |     | | | 
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | |       |     |       |           |         | |             |   |         |     | |   | |   |   | | |   |   |   |     | | | 
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | +-----------|---------------------------------------------|---|---------|-----------|-----+   | | |   |   | +-|-----|---+ 
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | |     |     |       |           |         | |             |   |         |     | |   | |       | | |   |   | | |     | |   
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | |     |     |       |           | +-------|---------------|-------------+     | |   | |       | | |   |   | | |     | |   
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | |     |     |       |           | |       | |             |   |               | |   | |       | | |   |   | | |     | |   
 |     | | | |       |   | | | | |   | |   +-|-------+ |   | |   | |   | | | | |     |   +-|-------|-----------|-----------|-------------|-------------------|-|-----|-----------|-------|-------+ | |   
 |     | | | |       |   | | | | |   | |     | | |   | |   | |   | |   | | | | |     |   | |       |           | |       | |             |   |               | |   | |       | | |   |   | | |   | | |   
 |     | | | |       |   | | | | |   | |     | | |   | +---+ +---|-----|-|---|-+ +---|---|-|-----+ |           | +---------|-------------|---------+         | |   | |       | | |   |   | | |   | | |   
 |     | | | |       |   | | | | |   | |     | | |   |           | |   | | | |   |   |   | |     | |           |         | |             |   |     |         | |   | |       | | |   |   | | |   | | |   
 |     | | | |       |   | +-|-+ |   | |     | | |   +-----------|-|-----|---|-------|---|-|-------|---------------------+ |             |   |     |     +---|-------|-+     | | |   |   | | |   | | |   
 |     | | | |       |   |   |   |   | |     | | |               | |   | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |     | | |   |   | | |   | | |   
 |     | | | |   +---+ +-|---|-+ |   | |     | | |   +-----------|---+ | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   +-|-----------------------|-+ 
 |     | | | |   |     | |   | | |   | |     | | |   |           | | | | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   | | | |   |   | | |   | | | | 
 |     | | | |   +---------+ | +-------|-----|-+ |   |           | | | | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   | | | |   |   | | |   | | | | 
 |     | | | |         | | | |   |   | |     |   |   |           | | | | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   | | | |   |   | | |   | | | | 
 | +-----|-|-------------|-|-|---|---|-------|-------|-+         | | | | | | |   |   |   | | +-----+         +---+         |             |   +-+   |     |   | |   | | |   | +-------------|-+   | | | | 
 | |   | | | |         | | | |   |   | |     |   |   | |         | | | | | | |   |   |   | | |   |           | | |         |             |     |   |     |   | |   | | |   |   | |   |   | |     | | | | 
 | |   | | +-|---------|---|-|---|---|-|-----|---------|---------------|-|-----+ | +-|---+ | | +-------------|-------------|-------------|-------------------|-----|-+ +---|-+ | |   |   | |     | | | | 
 | |   | |   |         | | | |   |   | |     |   |   | |         | | | | | | | | | | |     | | | |           | | |         |             |     |   |     |   | |   |       | | | |   |   | |     | | | | 
 | |   | |   |         | | | |   |   | |     |   |   | |         | | | | | | | | | | |     | | | |           | | +---------|-----------------------|-----|---|-|---|---+   | | | |   |   | |     | | | | 
 | |   | |   |         | | | |   |   | |     |   |   | |         | | | | | | | | | | |     | | | |           | |           |             |     |   |     |   | |   |   |   | | | |   |   | |     | | | | 
 | |   | |   |         | | | |   |   | |     |   |   | +-----------+ | | | | | | | | |     | | | |           | |         +---------------------|---|---------|-|-------------|-|---------|-|-----+ | | Y 
 | |   | |   |         | | | |   |   | |     |   |   |           |   | | | | | | | | |     | | | |           | |         | |             |     |   |     |   | |   |   |   | | | |   |   | |       | |   
 | |   | |   |         | | | |   |   | |     |   |   +---------------|---|-|-----|-----------|-----------------|---------|---------------------|---|-----|-----|---|-------|-+ | |   |   | +-----+ | |   
 | |   | |   |         | | | |   |   | |     |   |               |   | | | | | | | | |     | | | |           | |         | |             |     |   |     |   | |   |   |   |   | |   |   |       | | |   
 | |   | | +-----------|-|-----+ |   | |     |   +---------------------|-|-|---+ | +---------------------------|---------|---------------|---------------------------------------------------------|-|-+ 
 | |   | | | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |             |     G   |     |   | |   |   |   |   | |   |   |       | | | | 
 | |   | +---|---------|---|---|-------|---------------------------------------------|-----|---|-|-----------------------|-|-------------|-----|---------|---|-------+ |   | +-------------+     | | | | 
 | |   |   | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |             |     |   |     |   | |   | | |   | | | |   |   | |     | | | | 
 | |   |   | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |       +-----|---------|-----+   | |   | +-|-----+ | |   |   | |     | | | | 
 | |   |   | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |       |     |     |   |         | |   |   |   |   | |   |   | |     | | | | 
 | | +-|---+ |         +-|---|-------|-|-------------------------------|-|---|---|---|---+ | | | |           | |         | |       |     |     |   |   +-+   | |   +-------------|---|-------+   | | | | 
 | | | |     |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |       |     |     |   |   | |   | |       |   |   | |   |   | | |   | | | | 
 | | | |     |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |     +---|-|---+   | +---|---------|---------------+   |   |   | |   |   | | |   | | | | 
 | | | |     |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |     |   | |   |   | |   |     |   |   | |   | |   |   |   |   | |   |   | | |   | | | | 
 | | | |   +---------------|-|---------------|-------------------|---|-|-|-|-|---|---|---|-|-|-|-|-------------------+   | |   |   | |   |     |   |   | +---+ |   |   |   | +---|---|-----|-+   | | | | 
 | | | |   | |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | | 
 | | | |   | |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | | 
 | | | |   | |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | | 
 | | | |   | |           | | | | |   | |     |     +-------------|---|-|---------|-+ |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | | 
 | | | |   | |           | | | | |   | |     |     |             |   | | | | |   | | |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | | 
 +-+ | |   +-------------------|-----|-------|-----|-------------+   | | | | |   | | |   | | | | |           +-----------------|---|-|---+     |   |   |       |   |   |   | | | |   |   | |     | | | | 
     | |     |           | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |   |   | |         |   |   |       |   |   |   | | | |   |   | |     | | | | 
 +---+ |     |           | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |   +-------------+ |   |   |       |   |   |   | | | |   |   | |     | | | | 
 |     |     |           | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |       | |       | |   |   |       |   |   |   | | | |   |   | |     | | | | 
 |     |     |     +---+ | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |       | |       | |   |   |       |   |   +-----|-|-|-----+ | | +-------+ | 
 |     |     |     |   | | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |       | |       | |   |   |       |   |       | | | |   | | | | |   | |   | 
 +-----|---------+ |   | | +-----|---|-------|-----|-----------------|-|-----------------+ +---|---------------+         | |       | |       | |   |   +-------|---|-------|-|-------|-|---|-+   | |   | 
       |     |   | |   | |   | | |   | |     |     |                 | | | | |   | | |       | | |                       | |       | |       | |   |           |   |       | | | |   | | | |     | |   | 
       |     |   | |   | |   | | |   +-------------|-------------+   | | | +-|---|-+ |       | | |                       | |       | |       | |   |           |   |   +---+ | | |   | | | | +-+ | |   | 
       |     |   | |   | |   | | |     |     |     |             |   | | |   |   |   |       | | J                       | |       | |       | |   |           |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   | +-------------|-----------+             |   | | |   |   |   |       | | |                       | |       | |       | +---|---+       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |                       | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       +---+           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   | 
       |     |   | |   |     +-+ |     |     |         +---------|---|-|-|-------|---|-------|-|---------|---|---------------------|---------|-----|---------------|-----------|-----+ +---------|-+   | 
       |     |   | |   |         |     |     |         |         |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |       | | | | |     | 
       |     |   | |   |         |     |     |         |         |   | | |   +-------|-------|---|-----+ |   |           +-|-----------------|-----+   +-----------|---|-----|-+ |       | | | | |     | 
       |     |   | |   |         |     |     |         |         |   | | |       |   |       | | |     | |   |             |       | |       |                 |   |   |     |   |       | | | | |     | 
       +-----|---------|---------+     +-----------------------------+ | |   +---|-+ |       | +-|-----|-----|-------------|---------|-------+                 |   |   |     |   |       | | | | |     | 
             |   | |   |                     |         |         |     | |   |   | | |       |   |     | |   |             |       | |                         |   |   |     |   |       | | | | |     | 
             |   | |   |                     |         |         |     | |   |   | | |       |   |     | |   |             |       | |                         |   +---+     |   |     +---+ | | | +---+ 
             |   | |   |                     |         |         |     | |   |   | | |       |   |     | |   |             |       | |                         |             |   |     | |   | | | |     
       +---------+ |   |                     |         |         |     | |   |   | | |       |   |     +-|---|-------------|-------|-+                         |             |   |   +-+ |   | +-|---+   
       |     |     |   |                     |         |         |     | |   |   | | |       |   |       |   |             |       |                           |             |   |   |   |   |   | | |   
       |     |     |   |                     |         |         |     | |   +-------|-------|---------------|-------------|---------+                         |             |   |   |   |   |   | | |   
       |     |     |   |                     |         |         |     | |       | | |       |   |       |   |             |       | |                         |             |   |   |   |   |   | | |   
       | +---+     |   |                     |         |         +-----|-|-------|-|---------|-----------|-------------------------|-----------------------------------------+ +-+   |   +---|-----|-+   
       | |         |   |                     |         |               | |       | | |       |   |       |   |             |       | |                         |               |     |       |   | |     
       | +-----------------------------------|---------|---------+     | +-------|---+       |   |       |   |             +-------|---------------------------+         +-----------|-------+   +-+     
       |           |   |                     |         |         |     |         | |         |   |       |   |                     | |                                   |     |     |                   
       |           +-----------------------------------+         |     |     +---+ |         +-----------+ +-----------------------|-------------------------------------------+     +-------+           
       |               |                     |                   |     |     |     |             |         | |                     | |                                   |                   |           
       |               |                   +---------------------|-----------|-----------------------------|-------------------------|-----------------------------------+                   +-------+   
       |               |                   | |                   |     |     |     |             |         | |                     | |                                                               |   
 +-----+               +-------------------|---------------------------+ +---------------------------------|-|-----------------------|-----------------------------------------------------+         |   
 |                                         | |                   |       |   |     |             |         | |                     | |                                                     |         |   
 |                 +-------------------------|-------------------|-------|---|-----+             |         | |                     | |                                                     |         |   
 |                 |                       | |                   |       |   |                   |         | |                     | |                                                     |         |   
 |                 |                     +---|-------------------|-----------|-----------------------------+ +---------------------+ |                                                     |   +-----+   
 |                 |                     | | |                   |       |   |                   |                                   |                                                     |   |         
 +-----------------+                     +-+ +-------------------+       +---+                   +-----------------------------------+                                                     +---+         
                                                                                                                                                                                                         )";

int main() {
    solution(input);
}
